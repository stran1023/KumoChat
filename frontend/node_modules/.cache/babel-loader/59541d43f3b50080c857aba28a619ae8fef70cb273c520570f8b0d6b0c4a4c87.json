{"ast":null,"code":"var _jsxFileName = \"D:\\\\Chuyen nganh\\\\\\u0110\\u1ED3 \\xE1n ATTT\\\\KumoChat\\\\frontend\\\\src\\\\components\\\\chat\\\\PrivateChat.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from \"react\";\nimport { Box, Typography, List, ListItem, ListItemButton, ListItemText, Divider } from \"@mui/material\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport MessageArea from \"./MessageArea\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PrivateChat() {\n  _s();\n  const {\n    token,\n    user\n  } = useContext(AuthContext);\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [departmentId, setDepartmentId] = useState(null);\n\n  // L·∫•y ph√≤ng ban c·ªßa m√¨nh tr∆∞·ªõc\n  useEffect(() => {\n    const fetchDepartment = async () => {\n      try {\n        var _res$data$department, _res$data$departments, _res$data$departments2;\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/me`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const depId = ((_res$data$department = res.data.department) === null || _res$data$department === void 0 ? void 0 : _res$data$department.id) || ((_res$data$departments = res.data.departments) === null || _res$data$departments === void 0 ? void 0 : (_res$data$departments2 = _res$data$departments[0]) === null || _res$data$departments2 === void 0 ? void 0 : _res$data$departments2.id);\n        setDepartmentId(depId);\n      } catch (err) {\n        console.error(\"‚ùå L·ªói l·∫•y ph√≤ng ban:\", err);\n      }\n    };\n    fetchDepartment();\n  }, [token]);\n\n  // Sau ƒë√≥ fetch user c√πng ph√≤ng ban\n  useEffect(() => {\n    const fetchUsers = async () => {\n      if (!departmentId) return;\n      try {\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/departments/${departmentId}/users`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const filtered = res.data.filter(u => u.id !== user.userId);\n        setUsers(filtered);\n      } catch (err) {\n        console.error(\"‚ùå L·ªói l·∫•y user trong ph√≤ng ban:\", err);\n      }\n    };\n    fetchUsers();\n  }, [departmentId, token, user.userId]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"subtitle1\",\n      children: \"\\uD83E\\uDDCD Ch\\u1ECDn ng\\u01B0\\u1EDDi trong ph\\xF2ng ban \\u0111\\u1EC3 nh\\u1EAFn tin\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(List, {\n      dense: true,\n      sx: {\n        maxHeight: 200,\n        overflow: \"auto\",\n        bgcolor: \"#f4f4f4\",\n        mt: 1\n      },\n      children: users.map(u => /*#__PURE__*/_jsxDEV(ListItem, {\n        disablePadding: true,\n        children: /*#__PURE__*/_jsxDEV(ListItemButton, {\n          onClick: () => setSelectedUser(u),\n          children: /*#__PURE__*/_jsxDEV(ListItemText, {\n            primary: u.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 13\n        }, this)\n      }, u.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Divider, {\n      sx: {\n        my: 2\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), selectedUser && /*#__PURE__*/_jsxDEV(MessageArea, {\n      mode: \"private\",\n      target: selectedUser\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 5\n  }, this);\n}\n_s(PrivateChat, \"LCWiO7mJSsGD/doY308LtItsGq0=\");\n_c = PrivateChat;\nvar _c;\n$RefreshReg$(_c, \"PrivateChat\");","map":{"version":3,"names":["useState","useEffect","useContext","Box","Typography","List","ListItem","ListItemButton","ListItemText","Divider","axios","AuthContext","MessageArea","jsxDEV","_jsxDEV","PrivateChat","_s","token","user","users","setUsers","selectedUser","setSelectedUser","departmentId","setDepartmentId","fetchDepartment","_res$data$department","_res$data$departments","_res$data$departments2","res","get","process","env","REACT_APP_API_URL","headers","Authorization","depId","data","department","id","departments","err","console","error","fetchUsers","filtered","filter","u","userId","children","variant","fileName","_jsxFileName","lineNumber","columnNumber","dense","sx","maxHeight","overflow","bgcolor","mt","map","disablePadding","onClick","primary","username","my","mode","target","_c","$RefreshReg$"],"sources":["D:/Chuyen nganh/ƒê·ªì √°n ATTT/KumoChat/frontend/src/components/chat/PrivateChat.jsx"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Box, Typography, List, ListItem, ListItemButton, ListItemText, Divider } from \"@mui/material\";\r\nimport axios from \"axios\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport MessageArea from \"./MessageArea\";\r\n\r\nexport default function PrivateChat() {\r\n  const { token, user } = useContext(AuthContext);\r\n  const [users, setUsers] = useState([]);\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n  const [departmentId, setDepartmentId] = useState(null);\r\n\r\n  // L·∫•y ph√≤ng ban c·ªßa m√¨nh tr∆∞·ªõc\r\n  useEffect(() => {\r\n    const fetchDepartment = async () => {\r\n      try {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/auth/me`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        const depId = res.data.department?.id || res.data.departments?.[0]?.id;\r\n        setDepartmentId(depId);\r\n      } catch (err) {\r\n        console.error(\"‚ùå L·ªói l·∫•y ph√≤ng ban:\", err);\r\n      }\r\n    };\r\n    fetchDepartment();\r\n  }, [token]);\r\n\r\n  // Sau ƒë√≥ fetch user c√πng ph√≤ng ban\r\n  useEffect(() => {\r\n    const fetchUsers = async () => {\r\n      if (!departmentId) return;\r\n      try {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/departments/${departmentId}/users`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        const filtered = res.data.filter(u => u.id !== user.userId);\r\n        setUsers(filtered);\r\n      } catch (err) {\r\n        console.error(\"‚ùå L·ªói l·∫•y user trong ph√≤ng ban:\", err);\r\n      }\r\n    };\r\n    fetchUsers();\r\n  }, [departmentId, token, user.userId]);\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"subtitle1\">üßç Ch·ªçn ng∆∞·ªùi trong ph√≤ng ban ƒë·ªÉ nh·∫Øn tin</Typography>\r\n      <List dense sx={{ maxHeight: 200, overflow: \"auto\", bgcolor: \"#f4f4f4\", mt: 1 }}>\r\n        {users.map(u => (\r\n          <ListItem key={u.id} disablePadding>\r\n            <ListItemButton onClick={() => setSelectedUser(u)}>\r\n              <ListItemText primary={u.username} />\r\n            </ListItemButton>\r\n          </ListItem>\r\n        ))}\r\n      </List>\r\n      <Divider sx={{ my: 2 }} />\r\n      {selectedUser && (\r\n        <MessageArea mode=\"private\" target={selectedUser} />\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}