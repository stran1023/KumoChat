{"ast":null,"code":"var _jsxFileName = \"D:\\\\Chuyen nganh\\\\\\u0110\\u1ED3 \\xE1n ATTT\\\\KumoChat\\\\frontend\\\\src\\\\components\\\\chat\\\\PrivateChatAdmin.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useContext } from \"react\";\nimport { Box, Typography, List, ListItem, ListItemButton, ListItemText, Divider } from \"@mui/material\";\nimport axios from \"axios\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport MessageArea from \"./MessageArea\";\nimport { SocketContext } from \"../../context/SocketContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PrivateChat() {\n  _s();\n  const {\n    token\n  } = useContext(AuthContext);\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const {\n    socket\n  } = useContext(SocketContext);\n  const [onlineUserIds, setOnlineUserIds] = useState([]);\n  useEffect(() => {\n    if (!socket) return;\n    socket.on(\"update_online_users\", ids => setOnlineUserIds(ids));\n    return () => socket.off(\"update_online_users\");\n  }, [socket]);\n\n  // L·∫•y t·∫•t c·∫£ user\n  useEffect(() => {\n    const fetchAllUsers = async () => {\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/admin/users`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setUsers(res.data); // ‚úÖ ƒë√∫ng function name\n    };\n    fetchAllUsers();\n  }, [token]);\n  const [messages, setMessages] = useState([]);\n\n  // Load tin nh·∫Øn c≈©\n  useEffect(() => {\n    const fetchHistory = async () => {\n      if (!selectedUser) return;\n      try {\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/messages/private/${selectedUser.id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setMessages(res.data); // üëà l∆∞u tin nh·∫Øn c≈©\n      } catch (err) {\n        console.error(\"‚ùå Kh√¥ng l·∫•y ƒë∆∞·ª£c tin nh·∫Øn c≈©:\", err);\n      }\n    };\n    fetchHistory();\n  }, [selectedUser, token]);\n  const filteredUsers = users.filter(u => u.role !== \"ADMIN\");\n  return /*#__PURE__*/_jsxDEV(Box, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"subtitle1\",\n      children: \"\\uD83E\\uDDCD Ch\\u1ECDn ng\\u01B0\\u1EDDi trong ph\\xF2ng ban \\u0111\\u1EC3 nh\\u1EAFn tin\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(List, {\n      dense: true,\n      sx: {\n        maxHeight: 200,\n        overflow: \"auto\",\n        bgcolor: \"#f4f4f4\",\n        mt: 1\n      },\n      children: filteredUsers.map(u => /*#__PURE__*/_jsxDEV(ListItem, {\n        disablePadding: true,\n        children: /*#__PURE__*/_jsxDEV(ListItemButton, {\n          onClick: () => setSelectedUser(u),\n          children: /*#__PURE__*/_jsxDEV(ListItemText, {\n            primary: u.username,\n            secondary: onlineUserIds.includes(u.id) ? \"üü¢ Online\" : \"‚ö™Ô∏è Offline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }, this)\n      }, u.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Divider, {\n      sx: {\n        my: 2\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), selectedUser ? /*#__PURE__*/_jsxDEV(MessageArea, {\n      mode: \"private\",\n      target: selectedUser,\n      userList: users,\n      initialMessages: messages\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body2\",\n      color: \"text.secondary\",\n      children: \"Ch\\u1ECDn m\\u1ED9t ng\\u01B0\\u1EDDi \\u0111\\u1EC3 b\\u1EAFt \\u0111\\u1EA7u tr\\xF2 chuy\\u1EC7n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(PrivateChat, \"viOmDm1hq26rKJAkuiaFvvU5Wns=\");\n_c = PrivateChat;\nvar _c;\n$RefreshReg$(_c, \"PrivateChat\");","map":{"version":3,"names":["useState","useEffect","useContext","Box","Typography","List","ListItem","ListItemButton","ListItemText","Divider","axios","AuthContext","MessageArea","SocketContext","jsxDEV","_jsxDEV","PrivateChat","_s","token","users","setUsers","selectedUser","setSelectedUser","socket","onlineUserIds","setOnlineUserIds","on","ids","off","fetchAllUsers","res","get","process","env","REACT_APP_API_URL","headers","Authorization","data","messages","setMessages","fetchHistory","id","err","console","error","filteredUsers","filter","u","role","children","variant","fileName","_jsxFileName","lineNumber","columnNumber","dense","sx","maxHeight","overflow","bgcolor","mt","map","disablePadding","onClick","primary","username","secondary","includes","my","mode","target","userList","initialMessages","color","_c","$RefreshReg$"],"sources":["D:/Chuyen nganh/ƒê·ªì √°n ATTT/KumoChat/frontend/src/components/chat/PrivateChatAdmin.jsx"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { Box, Typography, List, ListItem, ListItemButton, ListItemText, Divider } from \"@mui/material\";\r\nimport axios from \"axios\";\r\nimport { AuthContext } from \"../../context/AuthContext\";\r\nimport MessageArea from \"./MessageArea\";\r\nimport { SocketContext } from \"../../context/SocketContext\";\r\n\r\nexport default function PrivateChat() {\r\n  const { token } = useContext(AuthContext);\r\n  const [users, setUsers] = useState([]);\r\n  const [selectedUser, setSelectedUser] = useState(null);\r\n\r\n  const { socket } = useContext(SocketContext);\r\n  const [onlineUserIds, setOnlineUserIds] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!socket) return;\r\n    socket.on(\"update_online_users\", (ids) => setOnlineUserIds(ids));\r\n    return () => socket.off(\"update_online_users\");\r\n  }, [socket]);\r\n\r\n  // L·∫•y t·∫•t c·∫£ user\r\n    useEffect(() => {\r\n    const fetchAllUsers = async () => {\r\n        const res = await axios.get(`${process.env.REACT_APP_API_URL}/admin/users`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setUsers(res.data); // ‚úÖ ƒë√∫ng function name\r\n    };\r\n    fetchAllUsers();\r\n    }, [token]);\r\n\r\n  const [messages, setMessages] = useState([]);\r\n  \r\n  // Load tin nh·∫Øn c≈©\r\n  useEffect(() => {\r\n    const fetchHistory = async () => {\r\n      if (!selectedUser) return;\r\n      try {\r\n        const res = await axios.get(\r\n          `${process.env.REACT_APP_API_URL}/messages/private/${selectedUser.id}`,\r\n          { headers: { Authorization: `Bearer ${token}` } }\r\n        );\r\n        setMessages(res.data); // üëà l∆∞u tin nh·∫Øn c≈©\r\n      } catch (err) {\r\n        console.error(\"‚ùå Kh√¥ng l·∫•y ƒë∆∞·ª£c tin nh·∫Øn c≈©:\", err);\r\n      }\r\n    };\r\n\r\n    fetchHistory();\r\n  }, [selectedUser, token]);\r\n\r\n  const filteredUsers = users.filter(u => u.role !== \"ADMIN\");\r\n\r\n  return (\r\n    <Box>\r\n      <Typography variant=\"subtitle1\">üßç Ch·ªçn ng∆∞·ªùi trong ph√≤ng ban ƒë·ªÉ nh·∫Øn tin</Typography>\r\n\r\n        <List dense sx={{ maxHeight: 200, overflow: \"auto\", bgcolor: \"#f4f4f4\", mt: 1 }}>\r\n        {filteredUsers.map((u) => (\r\n            <ListItem key={u.id} disablePadding>\r\n            <ListItemButton onClick={() => setSelectedUser(u)}>\r\n                <ListItemText\r\n                primary={u.username}\r\n                secondary={onlineUserIds.includes(u.id) ? \"üü¢ Online\" : \"‚ö™Ô∏è Offline\"}\r\n                />\r\n            </ListItemButton>\r\n            </ListItem>\r\n        ))}\r\n        </List>\r\n\r\n      <Divider sx={{ my: 2 }} />\r\n\r\n      {selectedUser ? (\r\n        <MessageArea\r\n          mode=\"private\"\r\n          target={selectedUser}\r\n          userList={users}\r\n          initialMessages={messages}\r\n        />\r\n      ) : (\r\n        <Typography variant=\"body2\" color=\"text.secondary\">\r\n          Ch·ªçn m·ªôt ng∆∞·ªùi ƒë·ªÉ b·∫Øt ƒë·∫ßu tr√≤ chuy·ªán\r\n        </Typography>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}